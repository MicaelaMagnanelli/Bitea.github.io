<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitea</title>
    <link rel="icon" href="Imagenes/Logo.ico" type="image/x-icon">
    <link rel="stylesheet" href="Css/styles-caja.css">
    <!-- TIPOGRAFÍA -->
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai+Looped:wght@100;200;300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
</head>

<body>

    <!-- Menú de navegación -->
    <header>
        <div class="logo">
            <a href="index.html">
                <img src="Imagenes/Logo de Bitea (Blanco).png" alt="Logo" class="logo-img">
            </a>
        </div>

        <!-- Ícono del menú hamburguesa (visible solo en móvil/tablet) -->
        <div class="hamburger" id="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>

        <!-- Menú principal -->
        <nav id="nav-menu">
            <ul class="menu">
                <li><a href="index.html" id="menu-link" data-i18n="menu-link">Menú</a></li>
                <li><a href="Comprar.html" id="comprar-link" data-i18n="comprar-link">Comprar</a></li>
                <li><a href="#" id="abrir-popup-personalizado" data-i18n="abrir-popup-personalizado">Personalizar</a>
                </li>
            </ul>
        </nav>

        <!-- Íconos de carrito -->
        <div class="icon-container">
            <!-- El enlace del carrito -->
            <a href="javascript:void(0)" onclick="mostrarCarrito()">
                <img src="Imagenes/Menu/Carrito.png" alt="Carrito" class="icon">
                <!-- El contador debe estar aquí, en el ícono del carrito -->
                <span id="contador-carrito" class="contador-carrito">0</span>
            </a>
        </div>

        <!-- Modal del carrito -->
        <div id="modal-carrito" class="modal">
            <div class="modal-contenido">
                <span class="cerrar" onclick="cerrarCarrito()">×</span>
                <div id="contenido-carrito"></div>
                <div id="total-carrito"></div>
                <div id="footer-carrito">
                    <button class="boton-finalizar" id="checkout-btn">Finalizar compra</button>
                </div>
            </div>
        </div>
    </header>

    <section class="container">
        <div class="box-area">
            <img src="Imagenes/Cajas/Caja sin fondo y sin sombra .png" alt="Bitea Box" class="box-image">
        </div>

        <div class="selection-area">
            <h2 class="title" id="select-flavors-title">Select 6 flavors</h2>
            <button class="buy-button" id="buy-button" disabled>Buy</button>
        </div>

        <div class="product-item cupcake-item">
            <img src="Imagenes/Personalizado/Cupcake con logo.png" alt="Custom Cupcake">
            <span class="cupcake-personalizado" id="cupcake-personalizado-text">Custom Cupcake</span>
        </div>

        <div class="agregar-personalizado">
            <button id="abrir-popup-personalizado-c3">Add +</button>
        </div>

        <!-- NUEVO CONTENEDOR PARA CUPCAKES PERSONALIZADOS -->
        <div id="cupcake-preview-list" class="preview-list"></div>


        <!-- Pop-up (popup-personalizado-c3) -->
        <div class="popup" id="popup-personalizado-c3">
            <span id="cerrar-popup-personalizado-c3" class="cerrar-popup">&times;</span>
            <h3 id="titulo-popup-personalizado-c3">Build your cupcake</h3>
            <p id="subtitulo-popup-personalizado-c3">Choose your Frosting</p>
            <img id="imagen-cupcake-personalizado-c3" class="imagen-cupcake"
                src="Imagenes/Personalizado/Frosting (CUPCAKE - PERSONALIZADO).png" alt="Cupcake with Frosting">
            <div class="indicador">
                <span id="indicador-frosting-personalizado-c3" class="active"></span>
                <span id="indicador-relleno-personalizado-c3"></span>
                <span id="indicador-masa-personalizado-c3"></span>
            </div>
            <ul id="opciones-frosting-personalizado-c3"></ul>
            <ul id="opciones-relleno-personalizado-c3" style="display: none;"></ul>
            <ul id="opciones-masa-personalizado-c3" style="display: none;"></ul>
            <button class="continue-btn" id="continuar-personalizado-c3" disabled>Continue</button>
        </div>

        <!-- Pop-up (log in) -->
        <div id="popup-login" class="popup-login hidden">
            <div class="popup-content">
                <button class="close-button">&times;</button>
                <h2 id="login-title">Entra</h2>
                <div class="popup-image">
                    <img src="Imagenes/Patron.png" alt="Imagen descriptiva">
                </div>
                <form>
                    <label for="email" id="email-label">Email</label>
                    <input type="email" id="email" name="email" placeholder="Ingresa tu correo" required>

                    <label for="password" id="password-label">Contraseña</label>
                    <input type="password" id="password" name="password" placeholder="Ingresa tu contraseña" required>

                    <a href="#" class="forgot-password" id="forgot-password-text">¿Olvidaste tu contraseña?</a>
                    <button type="submit" class="login-button" id="login-button">Entrar</button>
                </form>
                <p id="join-text">¿No tienes cuenta? <a href="Ccuenta.html" id="join-link">Únete</a></p>
                <div class="social-login">
                    <button class="google-login">
                        <img src="Imagenes/PopUp/icono-gmail.png" alt="Google" class="social-icon">
                        <span id="google-login-text">Entra con Gmail</span>
                    </button>
                    <button class="apple-login">
                        <img src="Imagenes/PopUp/icono-apple.png" alt="Apple" class="social-icon">
                        <span id="apple-login-text">Entra con Apple</span>
                    </button>
                    <button class="facebook-login">
                        <img src="Imagenes/PopUp/icono-facebook.png" alt="Facebook" class="social-icon">
                        <span id="facebook-login-text">Entra con Facebook</span>
                    </button>
                </div>
            </div>
        </div>


    </section>

    <!-- Pop-up (popup-personalizado) -->
    <div class="popup" id="popup-personalizado">
        <span id="cerrar-popup-personalizado" class="cerrar-popup">&times;</span>
        <h3 id="titulo-popup-personalizado">Armá tu cupcake</h3>
        <p id="subtitulo-popup-personalizado">Elegí tu Frosting</p>
        <img id="imagen-cupcake-personalizado" class="imagen-cupcake"
            src="Imagenes/Personalizado/Frosting (CUPCAKE - PERSONALIZADO).png" alt="Cupcake con Frosting">
        <div class="indicador">
            <span id="indicador-frosting-personalizado" class="active"></span>
            <span id="indicador-relleno-personalizado"></span>
            <span id="indicador-masa-personalizado"></span>
        </div>
        <ul id="opciones-frosting-personalizado"></ul>
        <ul id="opciones-relleno-personalizado" style="display: none;"></ul>
        <ul id="opciones-masa-personalizado" style="display: none;"></ul>
        <button class="continue-btn" id="continuar-personalizado" disabled>Continuar</button>
    </div>

    <!-- Insertar el código JavaScript aquí -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            try {
                // Verificar que translations.js esté cargado
                if (!window.translations) {
                    console.error('translations.js no está cargado');
                    return;
                } else {
                    console.log('translations.js cargado correctamente:', Object.keys(translations));
                }

                // --- Funciones comunes ---
                const getCurrentLanguage = () => {
                    const lang = localStorage.getItem('language') || 'es';
                    console.log('Idioma actual:', lang);
                    return lang;
                };

                const getTranslation = (key, lang) => {
                    if (!window.translations || !translations[lang]) {
                        console.warn(`No se encontraron traducciones para idioma "${lang}" o clave "${key}"`);
                        return key;
                    }
                    const translation = translations[lang][key] || key;
                    console.log(`Traduciendo clave "${key}" en idioma "${lang}":`, translation);
                    return translation;
                };

                // --- Lógica para cerrar el popup de login ---
                const popupLogin = document.getElementById('popup-login');
                const closeLoginButton = document.querySelector('#popup-login .close-button');

                const closeLoginPopup = () => {
                    if (popupLogin) {
                        popupLogin.classList.add('hidden');
                        console.log('Popup de login cerrado');
                    }
                };

                if (closeLoginButton) {
                    closeLoginButton.addEventListener('click', closeLoginPopup);
                } else {
                    console.warn('Botón .close-button no encontrado en #popup-login');
                }

                // Cerrar el pop-up al hacer clic fuera del contenido
                if (popupLogin) {
                    popupLogin.addEventListener('click', (e) => {
                        if (e.target === popupLogin) {
                            closeLoginPopup();
                        }
                    });
                }

                // --- Lógica del popup de personalización ---
                const popup = document.getElementById('popup-personalizado');
                const abrirPopup = document.getElementById('abrir-popup-personalizado');
                const cerrarPopup = document.getElementById('cerrar-popup-personalizado');
                const continuar = document.getElementById('continuar-personalizado');
                const tituloPopup = document.getElementById('titulo-popup-personalizado');
                const subtituloPopup = document.getElementById('subtitulo-popup-personalizado');
                const imagenCupcake = document.getElementById('imagen-cupcake-personalizado');
                const indicadores = popup ? popup.querySelectorAll('.indicador span') : [];

                let etapaActual = 0; // 0 = Frosting, 1 = Relleno, 2 = Masa

                const etapas = [
                    {
                        titulo: 'popup-title',
                        subtitulo: 'subtitulo-0',
                        imagen: 'Imagenes/Personalizado/Frosting (CUPCAKE - PERSONALIZADO).png',
                        opciones: [
                            'frosting-manzanas-asadas',
                            'frosting-limon',
                            'ganash-chocolate-amargo',
                            'frosting-queso-caramelo',
                            'cobertura-chocolate-ddl',
                            'crema-helada',
                            'frosting-pistacho',
                            'frosting-banana-caramelo',
                            'frosting-caramelo-sal-pretzel',
                            'frosting-flynn',
                            'frosting-cookies-cream',
                            'frosting-cereales'
                        ],
                        id: 'opciones-frosting-personalizado'
                    },
                    {
                        titulo: 'popup-title',
                        subtitulo: 'subtitulo-1',
                        imagen: 'Imagenes/Personalizado/Relleno (CUPCAKE - PERSONALIZADO).png',
                        opciones: [
                            'manzanas-caramelo',
                            'crema-limon-merengue',
                            'crema-cacao',
                            'ddl-bitea',
                            'crema-helada-relleno',
                            'pistacho-nuez',
                            'banana-caramelo',
                            'flynn-bite-relleno',
                            'cream-cookies',
                            'caramelo-pretzel',
                            'cereales-relleno'
                        ],
                        id: 'opciones-relleno-personalizado'
                    },
                    {
                        titulo: 'popup-title',
                        subtitulo: 'subtitulo-2',
                        imagen: 'Imagenes/Personalizado/Masa (CUPCAKES - PERSONALIZADO).png',
                        opciones: [
                            'chocolate',
                            'vainilla',
                            'marmolada',
                            'red-velvet'
                        ],
                        id: 'opciones-masa-personalizado'
                    }
                ];

                const habilitarContinuar = () => {
                    const opcionSeleccionada = document.querySelector(`#${etapas[etapaActual].id} input:checked`);
                    continuar.disabled = !opcionSeleccionada;
                    console.log('Continuar button enabled:', !continuar.disabled);
                };

                const manejarSeleccion = (event, categoria) => {
                    const opcionesDelGrupo = document.querySelectorAll(`#${categoria} input[type="checkbox"]`);
                    opcionesDelGrupo.forEach(opcion => {
                        if (opcion !== event.target) {
                            opcion.checked = false;
                        }
                    });
                    habilitarContinuar();
                };

                const continuarHandler = () => {
                    if (etapaActual < etapas.length - 1) {
                        etapaActual++;
                        actualizarContenido();
                    } else {
                        window.location.href = 'Cajaspersonalizar.html';
                    }
                };

                const mostrarPopup = () => {
                    console.log('mostrarPopup called');
                    if (popup) {
                        popup.classList.add('active');
                        console.log('Popup classList after adding active:', popup.classList);
                        actualizarContenido();
                    } else {
                        console.error('Popup element not found');
                    }
                };

                const cerrarPopupHandler = () => {
                    console.log('cerrarPopupHandler called');
                    if (popup) {
                        popup.classList.remove('active');
                        etapaActual = 0;
                        actualizarContenido();
                    }
                };

                const actualizarContenido = () => {
                    console.log('actualizarContenido called, etapaActual:', etapaActual);
                    const etapa = etapas[etapaActual];
                    const lang = getCurrentLanguage();

                    if (tituloPopup && subtituloPopup) {
                        tituloPopup.textContent = getTranslation(etapa.titulo, lang);
                        subtituloPopup.textContent = getTranslation(etapa.subtitulo, lang);
                    }

                    if (imagenCupcake) {
                        imagenCupcake.src = etapa.imagen;
                    }

                    document.querySelectorAll("#popup-personalizado ul[id^='opciones-']").forEach((ul) => {
                        ul.style.display = 'none';
                    });

                    const listaOpciones = document.querySelector(`#${etapa.id}`);
                    if (listaOpciones) {
                        listaOpciones.style.display = 'block';
                        listaOpciones.innerHTML = etapa.opciones
                            .map(opcion => {
                                const translated = getTranslation(opcion, lang);
                                return `<li><input type="checkbox" value="${opcion}"> ${translated}</li>`;
                            })
                            .join('');

                        listaOpciones.querySelectorAll('input').forEach(input => {
                            input.addEventListener('change', (event) => {
                                manejarSeleccion(event, etapa.id);
                            });
                        });
                    }

                    habilitarContinuar();

                    indicadores.forEach((indicador, index) => {
                        indicador.classList.toggle('active', index === etapaActual);
                    });
                };

                if (abrirPopup) {
                    abrirPopup.addEventListener('click', mostrarPopup);
                    console.log('Event listener added to abrirPopup');
                } else {
                    console.error('abrirPopup element not found');
                }

                if (cerrarPopup) {
                    cerrarPopup.addEventListener('click', cerrarPopupHandler);
                }

                if (continuar) {
                    continuar.addEventListener('click', continuarHandler);
                }

                // --- Lógica del menú hamburguesa ---
                const hamburger = document.getElementById('hamburger');
                const navMenu = document.getElementById('nav-menu');

                if (hamburger && navMenu) {
                    hamburger.addEventListener('click', () => {
                        hamburger.classList.toggle('active');
                        navMenu.classList.toggle('menu-open');
                    });

                    const menuLinks = document.querySelectorAll('.menu li a, .menu li button');
                    menuLinks.forEach(link => {
                        link.addEventListener('click', () => {
                            hamburger.classList.remove('active');
                            navMenu.classList.remove('menu-open');
                        });
                    });

                    document.addEventListener('click', (event) => {
                        if (!navMenu.contains(event.target) && !hamburger.contains(event.target)) {
                            hamburger.classList.remove('active');
                            navMenu.classList.remove('menu-open');
                        }
                    });

                    window.addEventListener('resize', () => {
                        if (window.innerWidth > 1024) {
                            hamburger.classList.remove('active');
                            navMenu.classList.remove('menu-open');
                        }
                    });
                } else {
                    console.warn('Faltan elementos del menú hamburguesa');
                }

                // --- Traducción de la página ---
                const updateLanguage = (lang) => {
                    localStorage.setItem('language', lang);
                    console.log('Idioma guardado:', lang);

                    // Actualizar botones de idioma
                    document.querySelectorAll('.lang-btn').forEach(btn => {
                        btn.setAttribute('aria-pressed', btn.dataset.lang === lang ? 'true' : 'false');
                    });

                    // Elementos a traducir
                    const elementsToTranslate = [
                        { id: 'menu-link', key: 'menu-link' },
                        { id: 'comprar-link', key: 'comprar-link' },
                        { id: 'abrir-popup-personalizado', key: 'personalizar-link' },
                        { id: 'select-6-flavors-title', key: 'select-6-flavors-title' },
                        { id: 'buy-button', key: 'buy-button' },
                        { id: 'cupcake-personalizado-text', key: 'cupcake-personalizado' },
                        { id: 'abrir-popup-personalizado-c3', key: 'agregar-btn' },
                        { id: 'login-title', key: 'login-title' },
                        { id: 'email-label', key: 'email-label' },
                        { id: 'password-label', key: 'password-label' },
                        { id: 'forgot-password-text', key: 'forgot-password-text' },
                        { id: 'join-text', key: 'join-text' },
                        { id: 'join-link', key: 'join-link' },
                        { id: 'login-button', key: 'login-button' },
                        { id: 'google-login-text', key: 'google-login-text' },
                        { id: 'apple-login-text', key: 'apple-login-text' },
                        { id: 'facebook-login-text', key: 'facebook-login-text' },
                        { id: 'footer-location', key: 'footer-location' },
                        { id: 'footer-history', key: 'footer-history' },
                        { id: 'footer-contact', key: 'footer-contact' },
                        { id: 'checkout-btn', key: 'checkout-btn' }
                    ];

                    elementsToTranslate.forEach(item => {
                        const element = document.getElementById(item.id);
                        if (element) {
                            element.textContent = getTranslation(item.key, lang);
                        }
                    });

                    // Actualizar placeholders del formulario de login
                    const emailInput = document.getElementById('email');
                    const passwordInput = document.getElementById('password');
                    if (emailInput) {
                        emailInput.placeholder = getTranslation('email-placeholder', lang);
                    }
                    if (passwordInput) {
                        passwordInput.placeholder = getTranslation('password-placeholder', lang);
                    }

                    // Actualizar pop-up de personalización si está abierto
                    if (popup && popup.classList.contains('active')) {
                        actualizarContenido();
                    }

                    // Actualizar pop-up de login si está abierto
                    if (popupLogin && !popupLogin.classList.contains('hidden')) {
                        elementsToTranslate
                            .filter(item => item.id.startsWith('login-') || item.id === 'email-label' || item.id === 'password-label' || item.id === 'forgot-password-text' || item.id === 'join-text' || item.id === 'join-link')
                            .forEach(item => {
                                const element = document.getElementById(item.id);
                                if (element) {
                                    element.textContent = getTranslation(item.key, lang);
                                }
                            });
                        if (emailInput) {
                            emailInput.placeholder = getTranslation('email-placeholder', lang);
                        }
                        if (passwordInput) {
                            passwordInput.placeholder = getTranslation('password-placeholder', lang);
                        }
                    }
                };

                // Agregar eventos de clic a los botones de idioma
                document.querySelectorAll('.lang-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        const lang = btn.dataset.lang;
                        updateLanguage(lang);
                    });
                });

                // Inicializar con el idioma guardado
                updateLanguage(getCurrentLanguage());
            } catch (e) {
                console.error('Error en personalizarc6.html:', e.message, e.stack);
            }
        });
    </script>

    <script src="js/popup-script6.js"></script>
    <script src="js/carrito.js"></script>
    <script src="js/translations.js"></script>
    <script src="js/common.js"></script>

    <script>(function () { function c() { var b = a.contentDocument || a.contentWindow.document; if (b) { var d = b.createElement('script'); d.innerHTML = "window.__CF$cv$params={r:'9338287cb8dcadac',t:'MTc0NTE4ODk4MS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);"; b.getElementsByTagName('head')[0].appendChild(d) } } if (document.body) { var a = document.createElement('iframe'); a.height = 1; a.width = 1; a.style.position = 'absolute'; a.style.top = 0; a.style.left = 0; a.style.border = 'none'; a.style.visibility = 'hidden'; document.body.appendChild(a); if ('loading' !== document.readyState) c(); else if (window.addEventListener) document.addEventListener('DOMContentLoaded', c); else { var e = document.onreadystatechange || function () { }; document.onreadystatechange = function (b) { e(b); 'loading' !== document.readyState && (document.onreadystatechange = e, c()) } } } })();</script>
</body>

<!-- Footer -->
<footer class="footer">
    <!-- Enlaces arriba: Ubicación, Historia, Contacto -->
    <div class="footer-links">
        <a class="footer-link"
            href="https://www.google.com/maps/place/El+Salvador+4689,+C1414+Cdad.+Aut%C3%B3noma+de+Buenos+Aires/@-34.5893949,-58.4294298,17z/data=!3m1!4b1!4m6!3m5!1s0x95bcb5879646ab49:0xab54ef9b6efc2346!8m2!3d-34.5893949"
            target="_blank">
            <img src="Imagenes/Footer/Locación.png" alt="Location" class="footer-icon">
            <span id="footer-location">Location</span>
        </a>
        <a class="footer-link" href="Historia.html">
            <img src="Imagenes/Footer/Historia.png" alt="History" class="footer-icon">
            <span id="footer-history">History</span>
        </a>
        <a class="footer-link" href="/cdn-cgi/l/email-protection#301d1913112f1d11171e1130181f041d11191c5e131f1d"
            target="_blank">
            <img src="Imagenes/Footer/Contacto.png" alt="Contact" class="footer-icon">
            <span id="footer-contact">Contact</span>
        </a>
    </div>

    <!--Redes sociales>-->
    <div class="footer-social">
        <a class="social-link" href="https://www.instagram.com/betular.patisserie/?hl=en" target="_blank">
            <img src="Imagenes/Footer/Redes/Ig.png" alt="Instagram" class="social-icon">
        </a>
        <a class="social-link" href="https://www.tiktok.com/@betular.patisserie?lang=en" target="_blank">
            <img src="Imagenes/Footer/Redes/Tik Tok.png" alt="TikTok" class="social-icon">
        </a>
        <a class="social-link" href="https://wa.me/1234567890" target="_blank">
            <img src="Imagenes/Footer/Redes/WhatsApp.png" alt="WhatsApp" class="social-icon">
        </a>
    </div>

    <!-- Imagen del logo con enlace -->
    <div class="footer-logo">
        <a href="index.html">
            <img src="Imagenes/Footer/Logo Bitea (Negro) .png" alt="Logo">
        </a>
    </div>
</footer>

<script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script>

</html>